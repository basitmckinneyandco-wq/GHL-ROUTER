<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>GHL PowerBI Router</title>
  <style>
    html,body { height:100%; margin:0; font-family: Arial, Helvetica, sans-serif; }
    #wrap { height:100%; display:flex; align-items:center; justify-content:center; }
    iframe { width:100%; height:100vh; border:0; }
    .denied { color:#b00; text-align:center; padding:30px; }
  </style>
</head>
<body>
  <div id="wrap">
    <div id="content">Loadingâ€¦</div>
  </div>

<script>
/* ---------- Configuration: map each email to their Power BI dashboard ---------- */
const USER_DASHBOARD_MAP = {
  "basitmckinneyandco@gmail.com": "https://app.powerbi.com/view?r=eyJrIjoiZjY2OGUxMDctYjgyMS00NGRkLThkYjAtYWQzZGEyMDY3MDIzIiwidCI6ImE3YTY2OWZlLWMxNDktNDNkYS04OTAyLTIxMDdhNWFkYjJiZCIsImMiOjl9",
  "zara@mckinneyandco.com": "https://app.powerbi.com/view?r=REPLACE_WITH_ZARA_LINK",
  "karimckinneyandco@gmail.com": "https://app.powerbi.com/view?r=REPLACE_WITH_KARIM_LINK"
};
/* ------------------------------------------------------------------------------ */

// get query params
function getQueryParams() {
  const q = {};
  const raw = location.search.replace(/^\?/, '');
  raw.split('&').forEach(pair => {
    if (!pair) return;
    const [k, v] = pair.split('=');
    q[decodeURIComponent(k)] = v ? decodeURIComponent(v) : '';
  });
  return q;
}

// show error
function showDenied() {
  document.getElementById('content').innerHTML =
    '<div class="denied">ðŸš« Access Denied â€” you are not authorized to view this dashboard.</div>';
}

// show dashboard iframe
function showIframe(url) {
  document.getElementById('content').innerHTML = `<iframe src="${url}" allowfullscreen></iframe>`;
}

// main logic
const qp = getQueryParams();
const email = qp.email || qp.user_email || qp.ghl_email;

if (email) {
  const lower = email.toLowerCase();
  if (USER_DASHBOARD_MAP[lower]) {
    showIframe(USER_DASHBOARD_MAP[lower]);
  } else {
    showDenied();
  }
} else {
  showDenied();
}
</script>
</body>
</html>
